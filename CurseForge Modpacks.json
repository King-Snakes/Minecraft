{
  "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PTERODACTYL PANEL - PTERODACTYL.IO",
  "meta": {
    "version": "PTDL_v2",
    "update_url": null
  },
  "exported_at": "2025-06-05T12:38:45-05:00",
  "name": "CurseForge Modpacks",
  "author": "MexicanKingSnakes@gmail.com",
  "description": "Support for CurseForge modpacks via the CurseForge API & required API key.",
  "features": [
    "eula",
    "java_version",
    "pid_limit"
  ],
  "docker_images": {
    "ghcr.io/king-snakes/multi-java:latest": "ghcr.io/king-snakes/multi-java:latest"
  },
  "file_denylist": [],
  "startup": "java $(cat .startup)",
  "config": {
    "files": "{\r\n    \"server.properties\": {\r\n        \"parser\": \"properties\",\r\n        \"find\": {\r\n            \"server-ip\": \"0.0.0.0\",\r\n            \"server-port\": \"{{server.build.default.port}}\",\r\n            \"query.port\": \"{{server.build.default.port}}\",\r\n            \"level-seed\": \"{{env.WORLD_SEED}}\",\r\n            \"motd\": \"{{env.MOTD}}\",\r\n            \"difficulty\": \"{{env.DIFFICULTY}}\",\r\n            \"resource-pack\": \"{{env.CUSTOM_TEXTUREPACK_URL}}\",\r\n            \"resource-pack-sha1\": \"{{env.CUSTOM_TEXTUREPACK_SHA1}}\"\r\n        }\r\n    }\r\n}",
    "startup": "{\r\n    \"done\": \"For help, type \"\r\n}",
    "logs": "{}",
    "stop": "stop"
  },
  "scripts": {
    "installation": {
      "script": "#!/bin/bash\r\nset -euo pipefail\r\n\r\n: \"${SERVER_DIR:=/mnt/server}\"\r\n: \"${TMP:=/mnt/server/tmp}\"\r\n: \"${MODPACK_NAME:?Missing MODPACK_NAME}\"\r\n: \"${VERSION_ID:=}\"\r\n: \"${API_KEY:?Missing API_KEY}\"\r\n: \"${MOD_DOWNLOAD_THREADS:=4}\"\r\nCF_GAME_ID=432\r\nCF_CLASS_ID=4471\r\nCF_BASE_URL=\"https://api.curseforge.com/v1\"\r\n\r\nrm -rf \"${SERVER_DIR:?}\"/* && cd \"$SERVER_DIR\"\r\n\r\n# Logging setup\r\nmkdir -p \"$SERVER_DIR/logs\"\r\nLOG_FILE=\"$SERVER_DIR/logs/install_$(date +%Y%m%d_%H%M%S).log\"\r\nexec > >(tee -a \"$LOG_FILE\") 2>&1\r\necho \"Logging to $LOG_FILE\"\r\n\r\nget_modpack_id() {\r\n  slug=$(echo \"$MODPACK_NAME\" | tr '[:upper:]' '[:lower:]' | sed 's/ /-/g; s/[^a-z0-9-]//g')\r\n  MODPACK_ID=$(curl -fsSL -H \"x-api-key: $API_KEY\" \"$CF_BASE_URL/mods/search?gameId=$CF_GAME_ID&classId=$CF_CLASS_ID&slug=$slug\" | jq -r '.data[0].id')\r\n  [[ -n \"$MODPACK_ID\" && \"$MODPACK_ID\" != \"null\" ]] && return\r\n  encoded=$(jq -sRr @uri <<< \"$MODPACK_NAME\")\r\n  for ((i=0; ; i+=50)); do\r\n    r=$(curl -fsSL -H \"x-api-key: $API_KEY\" \"$CF_BASE_URL/mods/search?gameId=$CF_GAME_ID&classId=$CF_CLASS_ID&searchFilter=$encoded&sortField=TotalDownloads&sortOrder=desc&index=$i&pageSize=50\")\r\n    MODPACK_ID=$(jq -r --arg n \"$MODPACK_NAME\" '.data[] | select(.name == $n) | .id' <<< \"$r\" | head -n1)\r\n    [[ -n \"$MODPACK_ID\" && \"$MODPACK_ID\" != \"null\" ]] && return\r\n    (( $(jq '.data | length' <<< \"$r\") < 50 )) && break\r\n  done\r\n  echo \"MODPACK NOT FOUND.\" && exit 1\r\n}\r\n\r\nget_download() {\r\n  data=$(curl -fsSL -H \"x-api-key: $API_KEY\" \"$CF_BASE_URL/mods/$MODPACK_ID\")\r\n  [[ -z \"$VERSION_ID\" || \"$VERSION_ID\" == \"latest\" ]] && VERSION_ID=$(jq -r '.data.mainFileId' <<< \"$data\")\r\n  file_data=$(curl -fsSL -H \"x-api-key: $API_KEY\" \"$CF_BASE_URL/mods/$MODPACK_ID/files/$VERSION_ID\")\r\n  [[ $(jq -r '.data.isServerPack' <<< \"$file_data\") == \"false\" ]] && VERSION_ID=$(jq -r '.data.serverPackFileId // empty' <<< \"$file_data\")\r\n  curl -sSL \"$(curl -fsSL -H \"x-api-key: $API_KEY\" \"$CF_BASE_URL/mods/$MODPACK_ID/files/$VERSION_ID/download-url\" | jq -r '.data')\" -o \"$SERVER_DIR/server.zip\"\r\n}\r\n\r\nget_loader() {\r\n  data=$(curl -fsSL -H \"x-api-key: $API_KEY\" \"$CF_BASE_URL/mods/$MODPACK_ID/files/$VERSION_ID\")\r\n  [[ $(jq -r '.data.isServerPack' <<< \"$data\") == \"true\" ]] && VERSION_ID=$(jq -r '.data.parentProjectFileId // empty' <<< \"$data\")\r\n  curl -sSL \"$(curl -fsSL -H \"x-api-key: $API_KEY\" \"$CF_BASE_URL/mods/$MODPACK_ID/files/$VERSION_ID/download-url\" | jq -r '.data')\" -o client.zip\r\n  unzip -jo client.zip manifest.json -d \"$SERVER_DIR\" && rm client.zip\r\n  mv \"$SERVER_DIR/manifest.json\" \"$SERVER_DIR/client.manifest.json\"\r\n  m=\"$SERVER_DIR/client.manifest.json\"\r\n  LOADER_ID=$(jq -r '.minecraft.modLoaders[] | select(.primary==true) | .id' \"$m\")\r\n  LOADER_NAME=\"${LOADER_ID%%-*}\"; LOADER_VERSION=\"${LOADER_ID#*-}\"; MINECRAFT_VERSION=$(jq -r '.minecraft.version' \"$m\")\r\n}\r\n\r\nget_java() {\r\n  [[ \"$MINECRAFT_VERSION\" =~ 1\\.(8|9|10|11) ]] && JAVA_VER=8 ||\r\n  [[ \"$MINECRAFT_VERSION\" =~ 1\\.(12|13|14|15|16\\.[0-4]) ]] && JAVA_VER=11 ||\r\n  [[ \"$MINECRAFT_VERSION\" == \"1.16.5\" ]] && JAVA_VER=16 ||\r\n  [[ \"$MINECRAFT_VERSION\" =~ 1\\.(17|18|19) ]] && JAVA_VER=17 ||\r\n  [[ \"$MINECRAFT_VERSION\" =~ 1\\.(20|21|22|23) ]] && JAVA_VER=21 || {\r\n    JAVA_VER=17\r\n    echo \"WARN: Unknown version $MINECRAFT_VERSION. Using Java 17.\"\r\n  }\r\n\r\n  JAVA_HOME=\"/opt/java/java$JAVA_VER\"\r\n  export JAVA_HOME\n  export PATH=\"$JAVA_HOME/bin:$PATH\"\n  echo \"Using Java $JAVA_VER from $JAVA_HOME\"\n  echo \"$JAVA_VER\" > \"$SERVER_DIR/.javaver\"\n  java -version || { echo \"Java failed to start. Ensure the version exists in the image.\"; exit 1; }\n}\n\r\njson_download_mods() {\r\n  echo \"DOWNLOADING MODS...\"\r\n  mkdir -p \"$SERVER_DIR/mods\"\r\n  jq -r '.files[] | select(.required) | \"\\( .projectID ) \\( .fileID )\"' \"$SERVER_DIR/manifest.json\" |\r\n  xargs -P \"$MOD_DOWNLOAD_THREADS\" -n2 bash -c '\r\n    modfile=\"'\"$SERVER_DIR\"'/mods/$2.jar\"\r\n    [[ -f \"$modfile\" ]] && echo \"CACHED: $2\" && exit 0\r\n    url=$(curl -sSL -H \"x-api-key: '\"$API_KEY\"'\" \"https://api.curseforge.com/v1/mods/$1/files/$2/download-url\" | jq -r \".data\")\r\n    curl -sSL \"$url\" -o \"$modfile\" && echo \"DOWNLOADED: $2\" || echo \"FAIL: $2\"\r\n  ' _\r\n}\r\n\r\ndownload_installer() {\r\n  local installer_path=\"$SERVER_DIR/$2\"\r\n  curl -fsSL -A \"Mozilla/5.0\" \"$1\" -o \"$installer_path\" || { echo \"Failed to download $2\"; exit 1; }\r\n  java -jar \"$installer_path\" ${3:-} || { echo \"Failed to run $2\"; exit 1; }\r\n  rm -f \"$installer_path\"\r\n}\r\n\r\njson_download_loader() {\r\n  echo \"INSTALLING ${LOADER_NAME^^}...\"\r\n  case \"$LOADER_NAME\" in\r\n    forge)\r\n      ver=\"${MINECRAFT_VERSION}-${LOADER_VERSION}\"\r\n      [[ \"$MINECRAFT_VERSION\" =~ 1\\.(7\\.10|8\\.9) ]] && ver=\"${ver}-${MINECRAFT_VERSION}\"\r\n      download_installer \"https://maven.minecraftforge.net/net/minecraftforge/forge/${ver}/forge-${ver}-installer.jar\" forge-installer.jar \"--installServer\"\r\n      LOADER_PATTERN=\"*forge-${ver}*.jar\"\r\n      ;;\r\n    neoforge)\r\n      a=\"neoforge\"; [[ \"$LOADER_VERSION\" =~ 1.20.1- ]] && a=\"forge\"\r\n      download_installer \"https://maven.neoforged.net/releases/net/neoforged/${a}/${LOADER_VERSION}/${a}-${LOADER_VERSION}-installer.jar\" neoforge-installer.jar \"--installServer\"\r\n      LOADER_PATTERN=\"*${a}-${LOADER_VERSION}*.jar\"\r\n      ;;\r\n    fabric)\r\n      url=$(curl -sSL https://meta.fabricmc.net/v2/versions/installer | jq -r '.[0].url')\r\n      download_installer \"$url\" fabric-installer.jar \"server -mcversion $MINECRAFT_VERSION -loader $LOADER_VERSION -downloadMinecraft\"\r\n      LOADER_PATTERN=\"*fabric*-server*.jar\"\r\n      ;;\r\n    quilt)\r\n      url=$(curl -sSL https://meta.quiltmc.org/v3/versions/installer | jq -r '.[0].url')\r\n      download_installer \"$url\" quilt-installer.jar \"install server $MINECRAFT_VERSION $LOADER_VERSION --download-server --install-dir=$SERVER_DIR\"\r\n      LOADER_PATTERN=\"*quilt*-server*.jar\"\r\n      ;;\r\n    *)\r\n      echo \"UNKNOWN LOADER: $LOADER_NAME\"\r\n      exit 1\r\n      ;;\r\n  esac\r\n  if [ -f \"$SERVER_DIR/unix_args.txt\" ]; then\n    cp \"$SERVER_DIR/unix_args.txt\" \"$SERVER_DIR/.startup\"\n    echo \"Using unix_args.txt for startup\"\n    return\n  fi\n\r\n  echo \"Looking for loader jar matching pattern: $LOADER_PATTERN\"\r\n  jar=$(find \"$SERVER_DIR\" -type f -iname \"$LOADER_PATTERN\" ! -iname \"*installer*\" | head -n1)\r\n  if [[ -n \"$jar\" ]]; then\n    cp \"$jar\" \"$SERVER_DIR/$(basename \"$jar\")\"\n    echo \"$(basename \"$jar\")\" > \"$SERVER_DIR/.serverjar\"\n    echo \"-jar $(basename \"$jar\")\" > \"$SERVER_DIR/.startup\"\n    echo \"Moved and using loader jar: $(basename \"$jar\")\"\n  else\n    echo \"ERROR: Loader jar not found matching pattern $LOADER_PATTERN\"\n    exit 1\n  fi\n}\r\n\r\ncleanup_tmp_files() {\r\n  mkdir -p \"$TMP\"\r\n  unzip -q \"$SERVER_DIR/server.zip\" -d \"$TMP\" || { echo \"Failed to unzip server.zip\"; exit 1; }\r\n  shopt -s dotglob\r\n  files=(\"$TMP\"/*)\r\n  [[ ${#files[@]} -eq 0 ]] && { echo \"No files extracted from server.zip\"; exit 1; }\r\n  [[ -d \"${files[0]}\" && ${#files[@]} -eq 1 ]] && files=(\"${files[0]}\"/*)\r\n  cp -ar \"${files[@]}\" \"$SERVER_DIR\" || { echo \"Failed to copy extracted files\"; exit 1; }\r\n  rm -rf \"$TMP\" \"$SERVER_DIR/server.zip\"\r\n}\r\n\r\ndownload_custom_mods() {\r\n  [[ -z \"${CUSTOM_MOD_URLS:-}\" ]] && return\r\n  IFS=',' read -ra URLS <<< \"$CUSTOM_MOD_URLS\"\r\n  mkdir -p \"$SERVER_DIR/mods\"\r\n  for url in \"${URLS[@]}\"; do\r\n    echo \"CUSTOM MOD: $url\"\r\n    curl -sSL -o \"$SERVER_DIR/mods/$(basename \"$url\")\" \"$url\" || echo \"FAILED TO DOWNLOAD $url\"\r\n  done\r\n}\r\n\r\n# ---------- EXECUTION ----------\r\nget_modpack_id\r\nget_download\r\nget_loader\r\nget_java\r\ncd \"$SERVER_DIR\"\r\ncleanup_tmp_files\r\n\r\n[[ -f \"$SERVER_DIR/manifest.json\" ]] && json_download_mods\r\n[[ -d \"$SERVER_DIR/overrides\" ]] && cp -r \"$SERVER_DIR/overrides/\"* \"$SERVER_DIR\" && rm -r \"$SERVER_DIR/overrides\"\r\n[[ -f \"$SERVER_DIR/client.manifest.json\" ]] && json_download_loader\r\n\r\ndownload_custom_mods\r\necho \"INSTALL COMPLETE.\"\n\n",
      "container": "ghcr.io/king-snakes/multi-java:latest",
      "entrypoint": "bash"
    }
  },
  "variables": [
    {
      "name": "MODPACK NAME",
      "description": "SEARCH BY NAME, MAKE SURE NAME IS EXACT AS SHOWN AT: https://www.curseforge.com/minecraft/modpacks/",
      "env_variable": "MODPACK_NAME",
      "default_value": "",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string",
      "field_type": "text"
    },
    {
      "name": "MODPACK ID",
      "description": "SEARCH BY ID, MAKE SURE ID IS EXACT AS SHOWN AT: https://www.curseforge.com/minecraft/modpacks/",
      "env_variable": "MODPACK_ID",
      "default_value": "925200",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string",
      "field_type": "text"
    },
    {
      "name": "MODPACK VERSION",
      "description": "SELECT MODPACK VERSION TO INSTALL, LEAVE BLANK TO USE LATEST",
      "env_variable": "VERSION_ID",
      "default_value": "latest",
      "user_viewable": true,
      "user_editable": true,
      "rules": "string",
      "field_type": "text"
    },
    {
      "name": "CURSEFORGE API KEY",
      "description": "CURSEFORGE API KEY IS REQUIRED - SEE: https://support.curseforge.com/en/support/solutions/articles/9000208346-about-the-curseforge-api-and-how-to-apply-for-a-key",
      "env_variable": "API_KEY",
      "default_value": "$2a$10$Pe78CsU2U9QuoK2r9ce1L.cRUxbqv4eLYXDEIdzrDWOHc49ihCfs.",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|string|max:60",
      "field_type": "text"
    },
    {
      "name": "MINECRAFT - WORLD SEED",
      "description": "SPECIFY WORLD SEED TO USE FOR THE SERVER",
      "env_variable": "WORLD_SEED",
      "default_value": "",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string",
      "field_type": "text"
    },
    {
      "name": "MINECRAFT - MOTD",
      "description": "SPECIFY MESSAGE OF THE DAY TO USE FOR THE SERVER",
      "env_variable": "MOTD",
      "default_value": "",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string",
      "field_type": "text"
    },
    {
      "name": "MINECRAFT - DIFFICULTY",
      "description": "SET THE DIFFICULTY LEVEL FOR THE SERVER (EASY, NORMAL, HARD)",
      "env_variable": "DIFFICULTY",
      "default_value": "hard",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string",
      "field_type": "text"
    },
    {
      "name": "CUSTOM_TEXTUREPACK_URL",
      "description": "PROVIDE URL TO TEXTUREPACK",
      "env_variable": "CUSTOM_TEXTUREPACK_URL",
      "default_value": "",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string",
      "field_type": "text"
    },
    {
      "name": "CUSTOM TEXTUREPACK SHA1",
      "description": "SHA1 HASH OF CUSTOM TEXTUREPACK FOR CLIENT VALIDATION",
      "env_variable": "CUSTOM_TEXTUREPACK_SHA1",
      "default_value": "",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string",
      "field_type": "text"
    },
    {
      "name": "CUSTOM MOD URLS",
      "description": "PROVIDE COMMA-SEPARATED URLS FOR CUSTOM MODS TO BE INSTALL INTO THE MODS FOLDER",
      "env_variable": "CUSTOM_MOD_URLS",
      "default_value": "",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string",
      "field_type": "text"
    }
  ]
}
